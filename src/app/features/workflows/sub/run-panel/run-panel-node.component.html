<div class="run-panel">
    <div class="header">
        <div class="title">{{ 'workflow.runPanel.title' | translate : { default: 'Run' } }}</div>
        <button mat-flat-button color="success" (click)="triggerRun()" [disabled]="!graphOk()">
            <mat-icon>play_arrow</mat-icon>
            <span class="ml-2">{{ 'workflow.runPanel.run' | translate : { default: 'Run simulation' } }}</span>
        </button>
    </div>


    @if (runs().length) {
    <div class="body" style="display:flex; flex-direction:column; gap:16px;">
        @for (r of runs(); track r.id; let i = $index) {
        <div class="run-block">
            <div class="run-block__header">
                <div class="run-meta">
                    <strong>Run #{{ runs().length - i }}</strong>
                    <span>• {{ r.startedAt | date:'short' }}</span>
                    <span>• {{ r.workflow.name }}</span>
                </div>
            </div>

            <app-pipeline-progress [workflow]="r.workflow" [runState]="r.state"
                (stageCancel)="stageCancel(r.id, $event)" (pipelineCancel)="pipelineCancel(r.id)">
            </app-pipeline-progress>
        </div>
        }
    </div>
    } @else {
    <div class="empty">
        {{ 'workflow.runPanel.empty' | translate : { default: 'No pipeline to run yet.' } }}
    </div>
    }
</div>